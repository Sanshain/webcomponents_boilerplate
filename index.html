<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>    

    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/1.0.22/webcomponents-sd-ce.js"></script>-->
    
    <script id='shadycss__polyfill'>
        /// ShadowCSS polyfill
        if (!this.attachShadow){
            window.addEventListener('DOMContentLoaded', function() {

                let style = document.createElement('style');                
                style.type  = 'text/css'; 
                document.head.appendChild(style);

                [].slice.apply(document.querySelectorAll('template')).forEach(function(template) {
                    
                    let res = template.innerHTML.replace(/<style>([\s\S]*?)<\/style>/, function(r ,group) {
                                                       
                        let cssReplaced = group.replace(/(\n\s*)([\.#\w\s]*){/g, function(_, offset, cls) {
                            
                            return offset + '.' +  template.id + ' ' + cls + '{';               // return `${offset}.${template.id} ${cls}{`
                        });
                        let specCssRepl = cssReplaced.replace(/\:host/g, '.' + template.id);    // `.${template.id}`
                        return specCssRepl;
                    });  

                    if (style.styleSheet) style.styleSheet.cssText = res;       // ie
                    else style.appendChild(document.createTextNode(res));       // *
                });
            });
        }
    </script>    

    <script id='es5__ce__polyfill'>

        if (!Array.from){

            window.addEventListener('DOMContentLoaded', function() {
                
                customElements = customElements || {};
                customElements.define = function(componentName, template){
                    
                    let sample = template.cloneNode(true);
                    sample.style.display = 'block';
                    [].slice.apply(document.querySelectorAll(componentName)).forEach(function(elem){
                        
                        let slot = elem.innerHTML; 
                        elem.innerHTML = slot 
                            ? sample.innerHTML.replace(/<slot>[\s\S]*?<\/slot>/, slot)        // вставляем slot
                            : sample.innerHTML;
                    });                            
                }                
                    
            });

            window.addEventListener('load', function(){
                
                let SliderComponent = document.getElementById('slider');                                    
                customElements.define("slider-carousel", SliderComponent);
            })

        }
    </script>        
    
    <script id='customelem_polyfill' src="polyfills/packages/custom-elements/build/custom-elements.min.js"></script>
    <script src="polyfills/packages/shadydom/build/shadydom.min.js"></script>           

    
    <style>
        template{
            display: none;
        }
    </style>
</head>
<body style="background-color: #666;">
    
    <template id='slider'>   
                      
        <style>
            /* :host { */
            :host{
                display: block;
                color: beige;
            }
            .p{
                
            }
        </style>               
        <span>sliding: </span><slot></slot>.     
        <div class="inside">456</div>
    </template>    

    <slider-carousel class='slider'>--</slider-carousel>
    <span>123</span>    
    

    
    <script>
        // вынести в отдельный скрипт ?

        class SliderComponent extends HTMLElement {
            constructor() {
                super();
                                
                let dom = document.getElementById('slider').content.cloneNode(true);

                // ShadyCSS.prepareTemplate( slider, 'div' )

                // this.attachShadow({ mode: "open" }).appendChild(dom);   
                this.attachShadow({ mode: "open" });                   
                // this.shadowRoot.innerHTML = `
                //     <style>
                //         :host {
                //             display: block;
                //             color: green;
                //         }
                //     </style>               
                //     <span>sliding1: </span><slot></slot>.   <hr> 
                // `
                this.shadowRoot.appendChild(dom);
            }
        }

        customElements.define("slider-carousel", SliderComponent);        
    </script>

</body>
</html>